<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mypromptl.ink | Shared Prompt</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <style>
        .hero {
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: auto;
        }
        .box {
            background-color: #fff;
            border: 1px solid #eee;
        }
        .title, .label {
            color: #222 !important;
        }
        #prompt-display {
            white-space: pre-wrap;
            word-wrap: break-word;
            background-color: #f5f5f5;
            border: 1px solid #eee;
            border-radius: 4px;
            padding: 1.25em 1.5em;
            font-family: monospace;
            color: #222;
        }
        .jump-to-ai .button {
            margin: 5px;
        }
        .navbar {
            background-color: #fff;
            border-bottom: 1px solid #eee;
        }
        .navbar-item.brand-logo img {
            max-height: 6vw;
            min-height: 48px;
            max-width: 90vw;
            height: auto;
            width: auto;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-brand">
                <a class="navbar-item brand-logo" href="/welcome.html">
                    <img src="Assets/Logo_light_transparent.png" alt="mypromptl.ink logo">
                </a>
            </div>
            <div class="navbar-menu">
                <div class="navbar-end">
                    <div class="navbar-item">
                        <a href="/creator.html" class="button is-primary is-outlined">
                            Create New Link
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <section class="hero is-fullheight">
        <div class="hero-body">
            <div class="container">
                <div class="box">
                    <div id="loading-state">
                        <p class="has-text-centered">Decoding prompt...</p>
                    </div>
                    <div id="content-state" class="is-hidden">
                        <h1 class="title is-4">Your Shared Prompt is Ready</h1>
                        <div class="field is-grouped">
                            <p class="control is-expanded">
                                <button id="copy-button" class="button is-primary is-fullwidth">
                                    Copy Prompt
                                </button>
                            </p>
                        </div>
                        <hr>
                        <div class="field">
                            <label class="label">Prompt Text:</label>
                            <div class="control">
                                <div id="prompt-display"></div>
                            </div>
                        </div>
                        <div class="field mt-5">
                            <p class="has-text-centered">Copy and share your link with anyone, anywhere!</p>
                        </div>
                    </div>
                    <div id="error-state" class="is-hidden">
                        <h1 class="title is-4 has-text-danger has-text-centered">Link Error</h1>
                        <p class="has-text-centered">The provided link could not be decoded. It may be corrupted or incomplete. Please ask the sender to share it again.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
    <script src="app.js"></script>
    <script>
    // Compose and show the destination link as a styled button below the prompt if a destination is present
    function extractDomain(url) {
        try {
            let domain = url.trim();
            domain = domain.replace(/^https?:\/\//i, '');
            domain = domain.replace(/^www\./i, '');
            domain = domain.split('/')[0];
            return domain;
        } catch (e) {
            return url;
        }
    }
    document.addEventListener('DOMContentLoaded', function() {
        // ...existing code...
        const redirectLink = document.getElementById('redirect-link');
        const destinationLinkField = document.getElementById('destination-link-field');
        // This assumes your app.js or similar sets a variable like destinationUrl when decoding
        if (typeof destinationUrl === 'string' && destinationUrl.trim()) {
            const domain = extractDomain(destinationUrl);
            redirectLink.textContent = `Go to ${domain}`;
            redirectLink.href = destinationUrl;
            destinationLinkField.classList.remove('is-hidden');
        } else {
            destinationLinkField.classList.add('is-hidden');
        }
    });
    </script>
    <footer class="footer">
        <div class="content has-text-centered">
            <p>
                <strong>mypromptl.ink</strong> is a tool for easily sharing prompts with others via a link, no matter the agent being used.
            </p>
        </div>
    </footer>
</body>
</html>